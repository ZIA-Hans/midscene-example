# MidScene Android 搜索功能自动化测试脚本
# 测试搜索指定专辑并点播的完整流程

# AI代理配置
agent:
  testId: "android-search-album-test"
  groupName: "Android 搜索功能测试套件"
  groupDescription: "测试Android平台搜索指定专辑并进行点播的功能流程"
  generateReport: true
  autoPrintReportMsg: true
  reportFileName: "android-search-album-report"
  replanningCycleLimit: 25
  aiActContext: "这是Android平台的搜索功能测试场景，包含搜索框输入、搜索结果验证、专辑筛选和详情页验证等功能。假设应用已安装并登录成功。"

# Android环境配置
android:
  # 设备ID，实际使用时需要替换为真实设备ID
  deviceId: "a23456ae"  # 模拟器ID或真实设备ID
  # 应用启动配置
  # launch:
  #   # 应用包名，实际使用时需要替换
  #   appPackage: "com.example.aiassistant"
  #   # 应用启动Activity
  #   appActivity: "com.example.aiassistant.MainActivity"
  # # 等待应用启动超时
  # launchTimeout: 30000
  # # ADB命令超时
  # adbTimeout: 15000
  autoDismissKeyboard: false

# 测试任务定义
tasks:
  # 任务3: 搜索指定专辑进行点播
  - name: "basic_3: 搜索指定专辑进行点播"
    continueOnNetworkIdleError: true
    flow:
      # # 等待应用启动完成
      # - sleep: 5000
      
      # 步骤1: 首页点击搜索框
      - aiTap: "点击首页的搜索框，进入搜索页面"
        # deepThink: true
      
      # 等待搜索页面加载
      # - sleep: 3000
      
      # 验证搜索主页元素
      - aiAssert: "搜索主页应该从上至下显示搜索栏输入框和热门搜索词条"
        errorMessage: "搜索主页元素显示异常"
        name: "check_search_homepage"
      
      # 步骤2: 输入"大唐双龙传"并搜索
      - aiTap: "点击搜索栏输入框激活它"
        # deepThink: true
      
      # 输入搜索关键词
      - aiInput: "大唐双龙传"
        locate: "在已激活的搜索输入框中输入文字"
        # deepThink: true
            
      # 方案1: 使用Enter键触发搜索（Android键盘搜索按钮通常对应Enter键）
      - aiKeyboardPress: "Enter"
        locate: "在已激活的搜索输入框中，按键盘上的Enter/搜索键"
        # deepThink: true

      # 验证搜索中状态
      # - aiAssert: "页面应该显示搜索中的加载状态提示"
      #   errorMessage: "搜索加载状态未显示"
      #   name: "check_search_loading"
      
      # 等待搜索结果加载
      - sleep: 1000
      
      # 步骤3: 检查搜索结果页面
      - aiAssert: "搜索结果页面应该返回四类结果：AI搜推荐专辑、精选专辑、所有专辑、相关的声音列表"
        errorMessage: "搜索结果分类不完整"
        name: "check_search_result_categories"
      
      # 步骤4: 切换至专辑标签页
      - aiTap: "点击专辑标签页切换到专辑列表视图"
        # deepThink: true
      
      # 验证专辑筛选方式
      - aiAssert: "专辑列表页应该展示3种筛选方式：综合排序、播放最多、最近更新"
        errorMessage: "专辑筛选方式不完整"
        name: "check_album_filters"
      
      # 步骤5: 选择指定专辑卡片
      - aiTap: "点击'大唐双龙传【精录】'专辑卡片进入详情页"
        # deepThink: true
      
      # 验证专辑详情页元素
      - aiAssert: "专辑详情页应该显示专辑封面、简介和音频列表"
        errorMessage: "专辑详情页元素不完整"
        name: "check_album_detail"
      
      # 验证音频列表可点播
      - aiAssert: "音频列表中的音频条目应该可以点击播放"
        errorMessage: "音频列表无法点播"
        name: "check_audio_playable"